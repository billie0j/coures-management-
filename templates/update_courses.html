{% extends "base.html" %}

{% block title %}Update Courses - Student Course Management System{% endblock %}

{% block content %}
<div class="card fade-in">
    <div class="card-header">
        <h2 class="card-title">
            <i class="fas fa-edit"></i>
            Update Student Courses
        </h2>
    </div>
    
    <!-- Student Information Display -->
    <div style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); padding: 1.5rem; border-radius: 8px; margin-bottom: 2rem;">
        <h3 style="color: #495057; margin-bottom: 1rem;">
            <i class="fas fa-user"></i> Student Information
        </h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
            <div>
                <strong style="color: #667eea;">Student ID:</strong>
                <div style="font-size: 1.1rem; margin-top: 0.25rem;">{{ student.student_id }}</div>
            </div>
            <div>
                <strong style="color: #667eea;">Name:</strong>
                <div style="font-size: 1.1rem; margin-top: 0.25rem;">{{ student.name }}</div>
            </div>
            <div>
                <strong style="color: #667eea;">Age:</strong>
                <div style="font-size: 1.1rem; margin-top: 0.25rem;">{{ student.age }} years</div>
            </div>
        </div>
    </div>
    
    <form method="POST" action="{{ url_for('update_courses', student_id=student.student_id) }}">
        <div class="form-group">
            <label for="courses" class="form-label">
                <i class="fas fa-book"></i> Current Courses
            </label>
            <div style="margin-bottom: 1rem;">
                <div class="course-tags">
                    {% set current_courses = student.courses.split(',') %}
                    {% for course in current_courses %}
                        {% if course.strip() %}
                            <span class="course-tag">{{ course.strip() }}</span>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>
        </div>

        <div class="form-group">
            <label for="courses" class="form-label">
                <i class="fas fa-edit"></i> Update Courses *
            </label>
            <textarea 
                id="courses" 
                name="courses" 
                class="form-control" 
                rows="4"
                placeholder="Enter courses separated by commas (e.g., Mathematics, Physics, Chemistry)"
                required
                style="resize: vertical; min-height: 100px;"
            >{{ student.courses }}</textarea>
            <small style="color: #6c757d; margin-top: 0.5rem; display: block;">
                <i class="fas fa-info-circle"></i>
                Separate multiple courses with commas. You can add, remove, or modify existing courses.
            </small>
        </div>

        <div style="display: flex; gap: 1rem; margin-top: 2rem; flex-wrap: wrap;">
            <button type="submit" class="btn btn-success">
                <i class="fas fa-save"></i> Update Courses
            </button>
            <a href="{{ url_for('view_students') }}" class="btn btn-secondary">
                <i class="fas fa-arrow-left"></i> Back to Students
            </a>
            <a href="{{ url_for('search_student') }}" class="btn btn-secondary">
                <i class="fas fa-search"></i> Search Another Student
            </a>
        </div>
    </form>
</div>

<div class="card">
    <div class="card-header">
        <h3 class="card-title">
            <i class="fas fa-graduation-cap"></i>
            Course Management Guidelines
        </h3>
    </div>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem;">
        <div>
            <h4 style="color: #667eea; margin-bottom: 1rem;">
                <i class="fas fa-plus-circle"></i> Adding Courses
            </h4>
            <ul style="color: #6c757d; line-height: 1.8; list-style: none; padding: 0;">
                <li style="padding: 0.5rem 0; border-bottom: 1px solid #e9ecef;">
                    <i class="fas fa-check" style="color: #28a745; margin-right: 0.5rem;"></i>
                    Add new courses to the existing list
                </li>
                <li style="padding: 0.5rem 0; border-bottom: 1px solid #e9ecef;">
                    <i class="fas fa-check" style="color: #28a745; margin-right: 0.5rem;"></i>
                    Use commas to separate course names
                </li>
                <li style="padding: 0.5rem 0;">
                    <i class="fas fa-check" style="color: #28a745; margin-right: 0.5rem;"></i>
                    Course names are case-sensitive
                </li>
            </ul>
        </div>
        
        <div>
            <h4 style="color: #667eea; margin-bottom: 1rem;">
                <i class="fas fa-edit"></i> Modifying Courses
            </h4>
            <ul style="color: #6c757d; line-height: 1.8; list-style: none; padding: 0;">
                <li style="padding: 0.5rem 0; border-bottom: 1px solid #e9ecef;">
                    <i class="fas fa-arrow-right" style="color: #007bff; margin-right: 0.5rem;"></i>
                    Edit course names directly in the text area
                </li>
                <li style="padding: 0.5rem 0; border-bottom: 1px solid #e9ecef;">
                    <i class="fas fa-arrow-right" style="color: #007bff; margin-right: 0.5rem;"></i>
                    Remove unwanted courses from the list
                </li>
                <li style="padding: 0.5rem 0;">
                    <i class="fas fa-arrow-right" style="color: #007bff; margin-right: 0.5rem;"></i>
                    Reorder courses as needed
                </li>
            </ul>
        </div>
        
        <div>
            <h4 style="color: #667eea; margin-bottom: 1rem;">
                <i class="fas fa-lightbulb"></i> Best Practices
            </h4>
            <ul style="color: #6c757d; line-height: 1.8; list-style: none; padding: 0;">
                <li style="padding: 0.5rem 0; border-bottom: 1px solid #e9ecef;">
                    <i class="fas fa-star" style="color: #ffc107; margin-right: 0.5rem;"></i>
                    Use consistent naming conventions
                </li>
                <li style="padding: 0.5rem 0; border-bottom: 1px solid #e9ecef;">
                    <i class="fas fa-star" style="color: #ffc107; margin-right: 0.5rem;"></i>
                    Avoid duplicate course entries
                </li>
                <li style="padding: 0.5rem 0;">
                    <i class="fas fa-star" style="color: #ffc107; margin-right: 0.5rem;"></i>
                    Keep course names descriptive but concise
                </li>
            </ul>
        </div>
    </div>
</div>

<!-- Course Suggestions -->
<div class="card">
    <div class="card-header">
        <h3 class="card-title">
            <i class="fas fa-list"></i>
            Common Course Suggestions
        </h3>
    </div>
    
    <div style="margin-bottom: 1rem;">
        <p style="color: #6c757d; margin-bottom: 1rem;">
            Click on any course below to add it to the student's course list:
        </p>
        <div id="courseSuggestions" style="display: flex; flex-wrap: wrap; gap: 0.5rem;">
            <button type="button" class="course-suggestion" data-course="Mathematics">Mathematics</button>
            <button type="button" class="course-suggestion" data-course="Physics">Physics</button>
            <button type="button" class="course-suggestion" data-course="Chemistry">Chemistry</button>
            <button type="button" class="course-suggestion" data-course="Biology">Biology</button>
            <button type="button" class="course-suggestion" data-course="Computer Science">Computer Science</button>
            <button type="button" class="course-suggestion" data-course="English Literature">English Literature</button>
            <button type="button" class="course-suggestion" data-course="History">History</button>
            <button type="button" class="course-suggestion" data-course="Geography">Geography</button>
            <button type="button" class="course-suggestion" data-course="Economics">Economics</button>
            <button type="button" class="course-suggestion" data-course="Psychology">Psychology</button>
            <button type="button" class="course-suggestion" data-course="Art">Art</button>
            <button type="button" class="course-suggestion" data-course="Music">Music</button>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const coursesTextarea = document.getElementById('courses');
    const form = document.querySelector('form');
    
    // Course suggestion functionality
    document.querySelectorAll('.course-suggestion').forEach(button => {
        button.addEventListener('click', function() {
            const course = this.getAttribute('data-course');
            const currentCourses = coursesTextarea.value.trim();
            
            // Check if course already exists
            const courseList = currentCourses.split(',').map(c => c.trim().toLowerCase());
            if (!courseList.includes(course.toLowerCase())) {
                if (currentCourses) {
                    coursesTextarea.value = currentCourses + ', ' + course;
                } else {
                    coursesTextarea.value = course;
                }
                
                // Visual feedback
                this.style.background = '#28a745';
                this.style.color = 'white';
                setTimeout(() => {
                    this.style.background = '';
                    this.style.color = '';
                }, 1000);
            } else {
                // Course already exists - show feedback
                this.style.background = '#ffc107';
                this.style.color = '#212529';
                setTimeout(() => {
                    this.style.background = '';
                    this.style.color = '';
                }, 1000);
            }
        });
    });
    
    // Auto-format courses on blur
    coursesTextarea.addEventListener('blur', function() {
        const courses = this.value.split(',').map(course => course.trim()).filter(course => course);
        this.value = courses.join(', ');
    });
    
    // Form submission enhancement
    form.addEventListener('submit', function(e) {
        const submitBtn = this.querySelector('button[type="submit"]');
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Updating Courses...';
        submitBtn.disabled = true;
    });
    
    // Real-time course count
    function updateCourseCount() {
        const courses = coursesTextarea.value.split(',').map(c => c.trim()).filter(c => c);
        const countElement = document.getElementById('courseCount');
        if (countElement) {
            countElement.textContent = courses.length;
        }
    }
    
    coursesTextarea.addEventListener('input', updateCourseCount);
    updateCourseCount(); // Initial count
});
</script>

<style>
.course-suggestion {
    background: #e9ecef;
    border: 1px solid #ced4da;
    color: #495057;
    padding: 0.5rem 1rem;
    border-radius: 20px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 0.875rem;
    font-weight: 500;
}

.course-suggestion:hover {
    background: #667eea;
    color: white;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(102, 126, 234, 0.3);
}

.course-suggestion:active {
    transform: translateY(0);
}

#courses:focus {
    border-color: #667eea;
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

/* Responsive adjustments */
@media screen and (max-width: 768px) {
    .course-suggestion {
        font-size: 0.8rem;
        padding: 0.4rem 0.8rem;
    }
    
    #courseSuggestions {
        justify-content: center;
    }
}
</style>
{% endblock %}